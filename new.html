<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Type Form</title>
    <style>
        body {
            text-align: center;
            margin: 0;
        }

        form {
            display: block;
            margin: auto;
            width: 50%;
        }

        .field-label {
            display: flex;
            flex-direction: column;
            margin-bottom: 10px;
        }

        .field-label label {
            font-weight: bold;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <form action="action">
        <!-- Тип события -->
        <div class="field-label">
            <label for="eventType" id="eventType">Тип события</label>
            <select name="eventType">
                <option value="#Авария" id="acident">Авария</option>
                <option value="#Инцидент" id="incident">Инцидент</option>
            </select>
        </div>
        <!-- Проблематика -->
        <div class="field-label">
            <label for="problematic">Проблематика</label>
            <input type="text" name="problematic" placeholder="Проблематика" id="problematic">
        </div>
        <!-- Оказанное влияние и массовость -->
        <div class="field-label">
            <label for="influenceAndMass">Оказанное влияние и массовость</label>
            <input type="text" name="influenceAndMass" placeholder="Оказанное влияние и массовость" id="influenceAndMass">
        </div>
        <!-- Текущий статус -->
        <div class="field-label">
            <label for="currentStatus">Текущий статус</label>
            <select name="currentStatus" id="currentStatus">
                <option value="В работе">В работе</option>
                <option value="Завершён">Завершён</option>
            </select>
        </div>
        <!-- Начало события -->
        <div class="field-label">
            <label for="startDate">Начало события</label>
            <input type="datetime-local" name="startDate" id="startDate">
        </div>
        <!-- Конец события -->
        <div class="field-label">
            <label for="endDate">Конец события</label>
            <input type="datetime-local" name="endDate" id="endDate">
        </div>
        <!-- Восстановление -->
        <div class="field-label">
            <label for="restoration">Восстановление</label>
            <input type="datetime-local" name="restoration" placeholder="Восстановление" id="restoration">
        </div>
        <!-- Источник -->
        <div class="field-label">
            <label for="source">Источник</label>
            <select name="source" id="source">
                <option value="Мониторинг">Мониторинг</option>
                <option value="Заявка от пользователя">Заявка от пользователя</option>
                <option value="Заявка от партнера">Заявка от партнера</option>
            </select>
        </div>
        <!-- Влияние -->
        <div class="field-label">
            <label for="impact" id="impact">Влияние</label>
            <div class="dropdown-checkbox form-group">
                <input type="checkbox"  name="place" value="Сайт" id="website"> Сайт
                <input type="checkbox"  name="place" value="МП" id="mp"> МП
                <input type="checkbox"  name="place" value="Поиск" id="search"> Поиск
                <input type="checkbox"  name="place" value="КЦ" id="cc"> КЦ
                <input type="checkbox"  name="place" value="БО" id="bo"> БО
                <input type="checkbox"  name="place" value="ВМС" id="wms"> ВМС
                <input type="checkbox"  name="place" value="Логистика" id="logistics"> Логистика
                <input type="checkbox"  name="place" value="Курьерская служба" id="courier"> Курьерская служба
                <input type="checkbox"  name="place" value="Промо" id="promo"> Промо
            </div>
        </div>
        <!-- План действий -->
        <div class="field-label">
            <label for="planOfAction">План действий</label>
            <input type="text" id="planOfAction" name="planOfAction" placeholder="Подключение дежурных SRE, разработчика и владельца продукта.">
        </div>
        <button id ="send">Отправить</button>
    </form>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        let tg = window.Telegram.WebApp;
        let send = document.getElementById("send");
        tg.expand();
        send.addEventListener(
            "click", () => {
                let eventType = {"acident": document.getElementById("acident").value,
                    "icident": document.getElementById("incident").value
                };
                let problematic = document.getElementById("problematic").value;
                let influenceAndMass = document.getElementById("influenceAndMass").value;
                let currentStatus = document.getElementById("currentStatus").value;
                let startDate = document.getElementById("startDate").value;
                let endDate = document.getElementById("endDate").value;
                let restoration = document.getElementById("restoration").value;
                let source = document.getElementById("source").value;
                let impact = {"website": document.getElementById("website").value,
                    "mp": document.getElementById("mp").value,
                    "search": document.getElementById("search").value,
                    "cc": document.getElementById("cc").value,
                    "bo": document.getElementById("bo").value,
                    "wms": document.getElementById("wms").value,
                    "logistics": document.getElementById("logistics").value,
                    "courier": document.getElementById("courier").value,
                    "promo": document.getElementById("promo").value
                };
                let planOfAction = document.getElementById("planOfAction").value;

                let data = {
                    eventType: eventType,
                    problematic: problematic,
                    influenceAndMass: influenceAndMass,
                    currentStatus: currentStatus,
                    startDate: startDate,
                    endDate: endDate,
                    restoration: restoration,
                    source: source,
                    impact: impact,
                    planOfAction: planOfAction
                }
                tg.sendData(JSON.stringify(data))
                tg.close();
            }
        )
    </script>
</body>
</html>